---
title: PDF Analyzer
---
# PDF Analyzer

## 概要
- PDF AnalyzerはPDFファイルの構造を理解しやすくするためのプログラムです。PDFのリファレンスマニュアルやPDFの構造を解説したホームページを見ながら使ってみてください。
- フリーソフトウエアです。

## 動作環境
- Windows10

## インストール
zipファイルを解凍し、install.exeを実行してください。
実行時に「WindowsによってPCが保護されました」と言う画面が出ます。その画面の「詳細情報」をクリックすると「実行」ボタンがあらわれます。「実行」ボタンを押すとインストールプログラムが実行されます。
インストーラは以下のランタイムがインストールされていない場合、自動的に取得してインストールします。
- Microsoft Visual C++ 再頒布可能パッケージ
  - 32ビット
https://aka.ms/vs/17/release/vc_redist.x86.exe
  - 64ビット
https://aka.ms/vs/17/release/vc_redist.x64.exe

- .NET デスクトップ ランタイム 6.0.6

  - 32ビット
https://download.visualstudio.microsoft.com/download/pr/cc04076c-d188-4c20-9b4f-89be06f1a39c/32da746ef46fbeedb4f609b67cb451c3/windowsdesktop-runtime-6.0.6-win-x86.exe

  - 64ビット
https://download.visualstudio.microsoft.com/download/pr/9d6b6b34-44b5-4cf4-b924-79a00deb9795/2f17c30bdf42b6a8950a8552438cf8c1/windowsdesktop-runtime-6.0.6-win-x64.exe

インターネットに接続できない環境でインストールする場合はあらかじめこれらのファイルをダウンロードして直接インストールしてください。

## 使用法
- PDFファイルをウィンドウにドロップするかツールバー左の「ファイルを開く」ボタンから選択して開いてください。
- 参照（Reference）をダブルクリックすると参照先へ行けます。
- ストリームのデータをダブルクリックするとデータを開くことができます。
- ストリームのデータを右クリックするとコンテキストメニューから開く方法を選択できます。
- Shortcutにはよく使う項目として/Rootとページツリーを展開したもの(Page list)があります。
- 設定
  - ツールバーの設定ボタンを押すと設定画面が出ます。設定画面では、ストリームデータを閲覧するためのテキストエディタ、バイナリエディタ、画像ビューアを指定することが出来ます。

## 連絡先等
- メール  ai@junkbulk.com
  - 問い合わせには必ずアプリ名とバージョンを書いてください。
- ホームページ https://junkbulk.com/
- Copyright(c) Junkbulk (Jinki-Keikaku) 

## 使用条件
- このプログラムはフリーソフトウエアです。
- このプログラムの著作権は、Junkbulk(Jinki-Keikaku)にあります。
- 本プログラムの使用によって何らかの障害が発生した場合でも、作者は一切の責任を負わないものとします。
- 作者は本プログラムのバグ修正、バージョンアップ等の一切のサポートの責は負いません。

## 使用ライブラリ等
- Cmap Resources
  - https://github.com/adobe-type-tools/cmap-resources
  - [License](license/CmapResources.txt)
- TreeListView
  - https://github.com/hazzik/TreeListView
  - [License](license/APL2.txt)

## 注意点
- 以下のPDFは開くことができません。
  - 暗号化されているファイルのストリームは内容を確認できません。暗号化のアルゴリズムは公開されているので対応予定です。
  - 対応していないデコード形式のコンテントストリームは展開できません。今のところ、ASCIIHexDecode, ASCII85Decode, RunLengthDecode, LZWDecode, CCITTFaxDecodeは未対応です。CCITTFaxDecode以外は簡単そうなので使っているファイルが見つかれば対応します（今のところ見たことがない）。
- Xrefについて
  - Xrefにはフリーエントリ(f)は表示されません。
- ショートカットについて
  - ページのショートカットはページツリーを展開して表示しています。ページの中には上位から継承可能なものがあり、個々のページに含まれない物があるので注意してください。例えば、/MediaBoxが継承されることは時々あります。/Resourcesも継承されるそうです（まだ見たことはありません）。
  ページ数の多いファイルのページツリーを/Rootからたどるとなぜこのショートカットを作ったかわかると思います。
- コンテントストリームについて
  - コンテントストリーム内で文字列オブジェクトはASCIIやShiftJisの時もありますが、たいていは普通に読めるコードではありません。それを変換するためにはページディクショナリのフォント情報が必要です。コンテントストリームからページディクショナリへの参照が取れないのでフォントの情報が取れません。プログラム内には文字コードの変換ルーチンがあるのでフォントの情報を参照できれば読むことが可能ですがよい方法がありません。
- 画像について
  - 画像形式のCCITTFaxは表示できません。CCITTFax形式は比較的使われているので対応したいのですが資料がみつかりませんでした（LibTiffを使えと言うのはみつかりましたがこれだけのために使うのはちょっとためらわれます）。簡単なら実装したいのでだれか仕様を教えてください。
  - JpegのCMYK形式の画像は色がおかしくなります（色反転されたように見えます）。JpegのCMYK形式の資料がみつかりませんでした。PDFファイルではJpegのCMYK形式はよく使われています。自分でデコーダを作ってもいいのでだれか仕様を教えてください。

## 履歴
- 2022/6/27 最初のリリース
