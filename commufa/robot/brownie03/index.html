<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html;charset=Shift_JIS">
<TITLE>Untitled Document</TITLE>
</HEAD>
<BODY>
<H2>プロトタイプ　Brownie03</H2>
<H3>目標</H3>
<BLOCKQUOTE dir=ltr style="MARGIN-RIGHT: 0px">
  <P>軽量化（失敗。2.7Kgになっちゃった。）<BR>階段昇降（多分昇れるるけど降りれない）。<BR>一歩を足裏より広くする（一歩15cm、足裏の長さより長い）。<BR>歩行速度の改善。<BR>じゅうたん、畳の上を歩く（未実施。多分ちょっと無理）。<BR>サーボを壊さない（失敗。また壊した（涙））。<BR>なんちゃって歩行からの脱却。フィードバック制御の実験を行う（足裏の感圧センサーをつけたけど、制御できなかった）。<BR><FONT 
  size=1>ROBO-ONE第4回大会参加（前回より目標が低くなってる、、、。けど予選通過で初めて一回勝てたけどなんかこう不本意な勝ち方というか、、、）。</FONT></P></BLOCKQUOTE>
<H3>仕様</H3>
<P>
<TABLE cellSpacing=0 cellPadding=0 border=0>
  
  <TR>
    <TD>高さ&nbsp;&nbsp; </TD>
    <TD>約45ｃｍ（頭部（？）を含む）&nbsp;</TD></TR>
  <TR>
    <TD>幅</TD>
    <TD>約27ｃｍ</TD></TR>
  <TR>
    <TD>奥行</TD>
    <TD>約9ｃｍ</TD></TR>
  <TR>
    <TD>重量（電池込み）</TD>
    <TD>2.7Kg（多分）。</TD></TR>
  <TR>
    <TD>サーボモーター</TD>
    <TD>つま先HS-85MG×2　足首HS-5645MG×4　ひざHS-5645MG×2　股間HS-5645MG×4　HS-5125MG×2（回転用）<BR>腰HS-5645MG×2<BR>肩HS-5645MG×4　ひじHS-5645MG×2</TD></TR>
  <TR>
    <TD>マイコン</TD>
    <TD>AKI-3069マイコンキット</TD></TR>
  <TR>
    <TD>センサー</TD>
    <TD>
      <P>2軸加速度センサー（制御には未使用。起き上がりの判定に使用）。<BR>足裏力センサー（6×2　<A 
      href="http://www.nitta.co.jp/products/RETS/sensor/product/FlexiForce/Elf%20Top.htm">FlexiForce</A>）使用予定でしたが取り外しました。</P></TD></TR>
  <TR>
    <TD>コントローラ</TD>
    <TD>Play Station用のJoy Padを使用（アナログ未使用）。AKI-3664フラットマイコンキットで読み取り。</TD></TR>
  <TR>
    <TD>無線</TD>
    <TD>
      <P>秋月で売ってたWP-203L,203H。</P></TD></TR>
  <TR>
    <TD>電源</TD>
    <TD>単三NiMH電池（秋月で売っていた1800mAhのもの）六本。スイッチングレギュレータによりマイコン（5V）、サーボ（6V）。</TD></TR>
  <TR>
    <TD>制御</TD>
    <TD>
      <P>関節軌道は世に言う（？）なんちゃって歩行。<BR>姿勢制御等、フィードバック系は無し。</P></TD></TR>
  <TR>
    <TD>歩行速度</TD>
    <TD>低速 6cm/s 高速 11cm/s&nbsp; 参考値（大股） 15cm/s</TD></TR>
  <TR>
    <TD>回転速度</TD>
    <TD>右旋回　4.5回/min 　左旋回　4.25回/min</TD></TR>
  <TR>
    <TD>連続駆動時間</TD>
    <TD>未計測（おそらくbrownie02より長時間駆動可能。多分60分くらい）</TD></TR>
  <TR>
    <TD>不整地歩行能力</TD>
    <TD>不明</TD></TR></TABLE></P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<H3>動画</H3>
<P>&nbsp;</P><A href="movie/ojigi_walk.mpg"></A>
<H3><A href="movie/ojigi_walk.mpg"></A>改善点（前回からの）</H3>
<UL>
  <LI>足裏に力センサーをつけて実験ができた。しかし、うまくいかなかったので結局はずした。 
  <LI>ひざ駆動範囲を少し広げた（120度-&gt;130度）。 
  <LI>起き上がりが安定した。 
  <LI>腕の構造を強化。 しかし、腕の付け根のサーボホーンが良く壊れる。 
  <LI>スイッチングレギュレータの採用。安定した6V系電源の供給。 
  <LI>つま先の構造の見直し。足裏より一歩の歩幅を広くできた。 </LI></UL>
<P>&nbsp;</P>
<H3>反省点</H3>
<DIR>
<LI>重くなりすぎた。 
<DIR>
<LI>予定重量は2.3Kgだった。 
<LI>腕、腰、足首にHS-5245MGを使う予定だったが壊れまくったのでHS-5645MGに交換した。 
<LI>強度不足のところが次々と出たので補強をした。 
<LI>スイッチングレギュレータが意外に重かった（100g以上）。</LI></DIR>
<LI>バランスが悪い。 
<DIR>
<LI>横幅があるのに、左側にスイッチングレギュレータをおいたので、重心が左側によっている。 
<LI>その程度で影響があるとは正直思ってなかった。 
<LI>横幅を縮めるか、できる限り中央に寄せるべきだった。brownie02と比べても横幅がかなり広がっているので、この影響が大きいかもしれない（運搬時、ケースに入らなくて肩をはずしてた）。</LI></DIR>
<LI>時間が無かった。 
<DIR>
<LI>今までと違う間接構造を採用した。経験が無いので苦労した。 
<LI>最初はマルチCPUにしようと思い、CANについて調べたりした。結局いろいろ困難で使わなかった。 
<LI>初めて1.27ピッチのユニバーサル基板を使った。ショートや接触不良をおこしまくり信頼性が低下した。 
<LI>小型化しようと思って表面実装部品を多用した。接触不良が増加した。 
<LI>AKI H8-3069ボードについているH8OSを採用した。全然使い物にならず無駄な時間をすごした。 
<DIR>
<LI>H8OSを採用して楽をしようと思ったが、マニュアルが全然使い物にならず、ソースを追いかけたりで無駄な時間をすごした。 
<LI>H8OSの2323C関係は当然、割り込みを使ってるとばかり思ってたらまったく使っていなかった。はまった。 
<LI>H8OSのEEPROM関係はどうもページを考慮して無いらしくて全然だめだった。当然そんなことは無いと思っていたので、新しいEEPROM買ったりCPUが壊れたと思って買いなおしたり、配線をしなおしたり、プルアップ抵抗を見直したりその他いろいろやって無駄な時間をすごした。 

<LI>上記のEEPROMの影響でH8OSのファイルシステムでとんでもないバグ（というか仕様なのか）があっておかげで、、、まあいいか。 </LI></DIR>
<LI>いろいろと設計を変更しすぎて混乱した。 
<LI>自分で足裏のセンサー（感圧ゴムもどき）を試作したり、無駄なことに時間を使いすぎた。 
<LI>マイコンが不安定でいつまでたってもまともなプログラムが作れなかった。実際まともにマイコンが動いたのは予選の2日前くらいだったかなぁ。 
<LI>私生活でいろいろあって、、、。</LI></DIR>
<LI>機体を一から設計しなおした 
<DIR>
<LI>今回の大会でひとつの機体を改造している人が完成度が高いと感じた。 
<LI>機体にはいい加減にけりをつけてソフトを重視すべきと思った。</LI></DIR>
<LI>足裏センサーをはずした </LI>
<DIR>
<LI>つけても今ひとつ安定しなかった。 
<LI>つま先4つ、かかと2つつけたが、かかとも4つのほうがいいと思った。 
<LI>足が着地するときの反動が結構大きい。 
<LI>センサーは（歩行中は）壊れなかったが、マイコン基板がショートしたりコネクタが接触不良を良くおこした。そのとき制御が当然おかしくなり困った。 
<DIR>
<LI>研究なら調子が悪いですむけど、実戦（？）ではここら辺にも強くなければいけない。 
<LI>あと、ちょっと違うけどEEPROMにセンサーパラメーターを書いていたんだけど、H8OSのEEPROMの書き込みの仕様があれでね、原因不明のデータ消失でとても困った。H8OSでEEPROMとFATファイルシステム使ってる人っているのかなぁ？</LI></DIR>
<LI>センサーの位置を調整したりして何度も両面テープをつけたりはがしたりするうちにセンサーを壊した。着地時の圧縮性の力には強いが、センサーをはがすときの引張りには弱かった。しかし、足裏にはいい特性だと思う。 

<LI>手動で足首関節を動かしてZMPを足裏の中央に持っていこうと思ったけど、難しかった。なぜ？ 
<LI>腰を動かすことでバランスをとると、うまく振動を抑えることができなかった。フィードバックを小さくするとあまり意味が無く、強くすると変な振動をする。 
<LI>両足接地時のバランス調整は？ 
<LI>センサーにかかる力の合計は安定時には（重量にほぼ比例するとすれば）一定のはずだが、かなり時々で差があった。ヒステリシスとかではなく、たぶん足が斜めに接地すると力が分散するからだと思う。で、そうなった場合何を信じればいいのだろうか？ 

<LI>センサーが飽和したときの対策は？個人的にはそこら辺を柔軟に対処できる方法が望ましい。 
<LI>偶然なんだけど、足首と股に過剰気味のフィードバックをかけると、反復横飛びと言うか、速い横歩きみたいなことができた。少しだけ可能性を感じた。 
<LI>センサーを一時的にせよ付けて、あらためて難しさを感じた。</LI></DIR>
<LI>本戦直前でデータが消えた。 
<DIR>
<LI>パラメータの調整中、EEPROMに書き込んでいる最中に電源を落とすかライトプロテクトスイッチを入れたかしたと思う。 
<LI>FATが壊れたみたいなので、最悪なんだが何とか書き込みの順番を工夫すると不完全ながら動くことを確認して動かした。オフセットもずれていたけど、3世代ぐらい前のバックアップがあったので復旧できた。<BR>だが、新たにパターンを登録できず、本戦がつまらないものになったと思う。 

<LI>製作中にマイコンが不安定だったので、バックアップを取る機能をつけ、その他いろいろ経験していたので対処できたと思う。<BR>しかし、とあるコマンドで途中で数秒停止状態になったりするので本戦はどきどきものだった。<BR>いい経験をした。こういう大会のハプニングはなんか経験値があがった気になるのでいい。でも、もうごめんだ（笑）。</LI></DIR>
<LI>不安定 
<DIR>
<LI>電気系統のショートが多い。 
<LI>軸受け部分の強度不足。 
<LI>ねじがすぐ緩む。</LI></DIR></LI></DIR>
<H3>これから</H3>
<UL>
  <LI>歩幅は広くなったので、次は高速化。 
  <UL>
    <LI>ほかの製作者は一歩0.5秒とかだけど、何でそんなに速く動くんだ？ 
    <LI>足の慣性がかなりあるんですけど、、、。 
    <LI>あと、着地時のショックもかなりある。 
    <UL>
      <LI>これは、今度足裏に緩衝用のゴムなどを組み込んで様子を見る予定。</LI></UL>
    <LI>速く動かすとひざがうまく伸びきらずに不安定になるので、やっぱりひざの構造を見直すべきか？ 
    <UL>
      <LI>ひざというと、今回いろいろ聞きまくったけど、同じ問題を抱えた人は少なかった。 
      <LI>ということは、自分の作り方が悪いのかなぁ。というか、歩き方がいけないのかも。 
      <LI>そういえば、パラメーターにサーボの特性のパラメータを組み込んでないのでそれがいけないのか？</LI></UL>
    <LI>足裏が滑ったほうがいいのかゴムのように滑らないほうが高速化には有利なのか？ 
    <UL>
      <LI>今回いろいろ試したが、実績のあるアルミにした。ゴムだと引っかかるし、プラスチックは滑りすぎて転ぶ。 
      <LI>これもひっそり他の人を調査していたが、今ひとつ答えが見つからなかった。極秘事項で本当は隠しているのかなぁ（笑）。</LI></UL>
    <LI>そういえば、H8OS使っているが232Cの送信が割り込み使ってないのに、サーボ用のデバッグメッセージを常に送信していた気がする。ここで動作が不自然になってるかも。 
    </LI></UL>
  <LI>センサーの使用。 
  <UL>
    <LI>ジャイロは有効そうだけど、高いからパス（多分）。 
    <LI>足裏センサーは気に入ったけど、つけ方や配置が難しかった。 
    <LI>加速度センサーは不安定だがそれなりの値を取り出せた。 
    <LI>問題はこれらをいかに組み合わせるかだけど、ひとまず足裏だけ使おうかな？</LI></UL>
  <LI>データの収集機能実装。 
  <UL>
    <LI>本当はセンサーをつけた段階で実装すべきだった。 
    <LI>今使ってるボードはメモリがふんだんにあるので、結構いいものが作れそう。</LI></UL>
  <LI>安定性の向上。 
  <LI>エンターテインメント性の向上（センスが無いので無理かも）。 
  <UL>
    <LI>モーション作成環境が貧弱なので、もうちょっと何とかする。 
    <LI>しかし、パソコンのディスプレイが800X600なので、インターフェースを作っててもかなりきつい。</LI></UL>
  <LI>外観をかっこよく（センスが無いので、、、）。 
  <UL>
    <LI>モーションも含めて助っ人がほしい。 
    <LI>しかし、機械の完成が遅いので無理かなぁ。</LI></UL>
  <LI>軽量化。 
  <UL>
    <LI>重いと全然歩けないので。 
    <LI>将来的には指も付けるので重量の余裕がほしい。 
    <LI>あまりやりたくないけど、サーボの蓋をはずすとかそんなレベルでやらなければすでにだめかも。</LI></UL>
  <LI>できれば連続的な速度調整、回転など。 
  <LI>より歩行を人間に近づける。</LI></UL>
<P>&nbsp;</P>
<H3>その他感想</H3>
<UL>
  <LI>カンファレンスに参加すればよかった、、、。 いろいろと情報があったみたいだし。 
  <LI>家では満足に動かないのに会場だと調子がいいという、他の人と逆の状況でなんか申し訳ない。 
  <LI>それでもやっぱり予想もしないハプニングがあったりで、本当に楽しかった（いや、苦しかった）。 
  <LI>やっぱりぼけボケで、名前と顔が一致しなかったり、わけのわからないことしゃべったりで申し訳ありません。 
  <LI>いい加減この人数だと控え室が狭くなかったですか？机で作業できない人もいたんじゃないのかなぁ。 
  <LI>今回の大会は予選も本戦も自分のことで手一杯でぜんぜん見れなかった。控え室では音声が無かったので様子が伝わらなかった。マジンガアは絶対パフォーマンスを見るぞと気合をいれて見に行ったけど。 

  <LI>だんだん歩行のこつがわかってきたので、次はやはり自動生成と思う。 
  <LI>モーションスクリプト（？）に適当な制御構文、サブルーチンコールを加えていくとだんだん本当に言語を作りたくなってきた。<BR>それと、コマンドインタプリタとかファイルシステムとかOS的になってっきたし、、、。 

  <LI>足裏センサーから重心（ZMP？）を求め、うまくコントロールするのは非常に困難だった。めどが立ちません。 
  <LI>つま先は大体コツがつかめてきた。今度はかかとの形状（面積）を考えようかなぁ。 
  <LI>40cm級はサイズ的に作りやすく、机の上で実験できるベストサイズと思って来たが、一歩が15cmをこえたのでもう机の上では歩かせられない（せいぜい4歩くらいしか歩けない）状況になってきた。どうしようか？ 

  <LI>今の関節構造は、特徴もあるがそれにもまして欠点が多い。ちゃんとした人はそれを気づいている。どうしよう？ 
  <LI>足裏は小さいほうが高速化には有利と信念を持ってきたが、今回の大会で他の参加者を見て、大きくても全然平気に思えてきた。足を早く動かすほうが、30cmから40ｃｍ級には合理的なんだろう。なんか、心がぐらつく。 

  <LI>堀さんとか宮田さんに会えず残念。私もあと少しで同じように不参加だったので、人ごとでは無いです。なんか夢さんにへなちょこなメールを送ってたし、、、、。あのころはマイコンが安定しないしで本当に泣きそうだった。 

  <LI>自分では、歩行速度の向上などレベルアップしたと思っていたが、周りのレベルがはるか上をいっている。みんなすごいなぁ。逆立ちは当たり前、バックドロップもありますかぁ、という感じ。予選を通って恥ずかしかった。<BR>もしも、データが飛んでいなかったらなんか新しい技に挑戦していたかもしれないが、控え室とかで作業をするのは危険だと今回思った。 

  <LI>会社で今回の大会のすごさを話したが、どうも今ひとつ伝えられない。去年まではわかる人間がいたのに。つまらん。<BR>決勝を見に来てくれた友人は感動してくれたようだ。というかそれが普通の反応だと思う。 

  <LI>というわけで、某友人に感謝。帰りが楽だったよ。 
  <LI>もしかして、予選通過で素人は私くらいですか？素人って、仕事で回路設計もソフト開発も機械設計もしてない、学生でもない（学生はアマチュアの鏡ですが）って意味で。と、いうわけで、いろいろな人、がんばってください。まだいけます。<BR>しかも、いろいろいいコンピューター（コントローラー）が出てくるみたいですし、サーボも良くなるみたいです。夢のようですね。自分が市販品のコントローラ使うかといえば、多分使わないでしょう。方式が全然違いますから。普通の人と。 

  <LI>今の構造は欠点が多いので、普通の構造にしようかと思ったけど、よく考えたら普通と違うから予選に残ったのかもしれないと、いまは思う。普通の構造にし、他の人と同じ歩き方にしたら（楽だけど）、それは（自分にとって）誰かの真似になると思う。真似る事は悪くない。が、それを超えることはかなりの実力が必要だろう。自分にはそれほどの実力は無い。 

  <LI>結局、大会後一週間で歩行が困難なほどガタが来てしまいました。今の歩行方法は着地時の反動が大きく、構造が持たないみたいです。もうちょっと見直ししてみます。というわけで、また作り直しです。とほほ。</LI></UL>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
</BODY>
</HTML>
