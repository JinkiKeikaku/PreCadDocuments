
                      LilliCad
                                             Copyright(c) らん　ゆうじろう
                                                    ran-yu@pluto.dti.ne.jp
---------------------------------------------------------------------------
★ 1. LilliCadとは？
　LilliCadは２DのCADです。小さくて軽いCADみたいなものとして作成されました。
正直言ってあまり機能はつけたくなかったのですが、いつのまにかDraw系のソフトの
ようにグラデェーションまでできるようになってしまいました。機能の増加に伴い、
大きさも約1MBと大きくなってしまいました(反省！)。

---------------------------------------------------------------------------
★ 2. LilliCadの特徴

・低機能な2DのCADです。わけのわからん、何とか空間とかはありません。
・レイヤーはメモリの許す限り増やせます（特に制限はありません）。
・レイヤーの表示は（EXCELのような）タブ形式となっています。
・UNDO、REDOは1000回までできます(メモリがあればの話。初期値は8回で設定で変更
できます)。
・自動的にスナップがかかります（最近はあたりまえか)。
・接線、平行線、垂線、円や線に接する円などが、比較的簡単に描けます（これくら
い当然か)。
・塗りつぶしにグラデーションがあります（Draw系じゃないんだからいらないかも)。
・保存ファイルのフォーマットがテキスト形式ですから、もしものときも安心です。
・いいことじゃないけど,ツールバーのカスタマイズはできません（必要ですか？)。
・DXFファイル、XDFファイル（IT'S CADの形式）、JWC（JW_CAD)を読み込めます。
JWK（JW_CAD)はパーツとして利用できます。DXFファイル、JWCは保存もできます。
　しかし、DXFの読み込みも保存もあまり多くのエレメントには対応していません（必
要になったら追加していきたいです)。


---------------------------------------------------------------------------
★ 3. 動作環境
  LilliCadは以下のOSで動作します。
        Windows 98
        Windows 95
        Windows NT 4.0（たぶん)
        Windows 2000（たぶん)
        Windows XP
  HDは2MBくらいあればいいでしょう。本体は小さいのでFDにも入ります。
　メモリはWindows 98なら32MBくらいあれば大丈夫です。

---------------------------------------------------------------------------
★ 4. 使用上の注意
　LilliCadは世に言うカンパウェアです。シェアウェアのように使用制限、使用期限
等は一切ありません。使用、配布等についてもフリーソフトと同じ扱いで作者に代価
等を支払うことなく無料で使用することができます。作者に連絡等も必要ありません
（でも、感想とかメールいただけるとうれしいです)。
　しかし、使ってみて気にいってくれて作者にちょっと寄付（？）したいな、という
方は下記の口座に（500円くらい）送金していただけると助かります。
　　UFJ銀行　岡崎駅前支店（店番号403）
　　口座番号　(普)458589
　　名義　　　ヤマグチマサアキ
　シェアウェアのようにパスワードとかありませんので、特に連絡等は必要ありませ
んが、メールでお知らせしていただけるとうれしいです。送金していただいてもサポ
ートが付くとか対応がよくなるとかメリットはありませんのでなんなんですが、あく
までも気持ちということで（笑)。
　また、送金していないからといってバグレポートや要望等を受け付けないというわ
けではありません。気にしないでください。

しかし、以下の事項に留意の上、ご使用いただくようお願いします。

    ・本プログラムの著作権は、らん　ゆうじろう(M.Yamaguchi)にあります。本プロ
　　　グラムの改変等は堅く禁じます。

    ・本プログラムの使用によって何らかの障害が発生した場合でも、作者は一切の
　　　責任を負わないものとします。

    ・作者は本プログラムのバグ修正、バージョンアップ等の一切のサポートの責は
　　　負いません。
　　
    ・ファイルフォーマット、ユーザーインターフェース等予告無く変更することが
　　　あります（しかし、過去のファイルは当然読めるようにしたいと思います）。

==========================       重要       ==================================
　Ver1.2.0からグループ図形とパーツのフォーマットが変わりました。グループ図形は
Ver1.2.0以降で作ったものも旧バージョンで読めるでしょうが、パーツに関しては、旧
バージョンでは読めません。
==============================================================================
---------------------------------------------------------------------------
★ 5. うだうだ
　いまオープンソースがはやりだからやりたいけど、とってもソースが汚い（しかも
コメントほとんど無し）のでできません。
　ファイルのフォーマットもつけたかったのですが、まだ公開できる資料を作ってい
ません（しかもそのうち変更するかも）。
　まだ、ごみ（？）が画面に残るようです。致命的なバグではないので修正はまだで
す。
  JW_CADの読みこみと保存に対応しましたが、かなり適当なのでどこまで出来たかど
うかわかりません（建具とかの属性フラグは無視しています）。
　JWKもなんとか読めるようになりました。情報をくださったかたがたありがとうござ
います。
　DWGのサポートはまずありません。フォーマットがわかりづらいし、読めるソフトも
持ってません。でも、読込みだけならあたりはつきそうですが（またまずい一言を）。
　あ、普通はDXFの対応ファイルバージョンとか書くんだろうな。でも、AutoCADが無
いからわからないです。対応しているエレメント（図形要素)とかは忘れました(てき
とうだなぁ。いや、DXFは初期に対応したもんで）。でも、たいていのものはいいと思
います。そのうち調べて対応表を作ります。たぶん。

　Ver1.2.0からグループ図形とパーツのフォーマットが変わりました。フォーマット
公開前でよかったです。グループ図形はVer1.2.0以降で作ったものも旧バージョンで
読めるでしょうが、パーツに関しては、旧バージョンでは読めません。すみません。
ここまでが限界でした。でもみんな新バージョンへ移行ということでよしとしましょ
う（笑)。これで多少（パーツファイルが）見やすくなったし。説明もしやすいと（な
んか個人的な事情ですが）。

  それにしても、ファイルのフォーマットを自分で考えるのは難しいですね。最初は
DXFが「なんて効率の悪いことをやってるんだ！」と思ってましたが、こういう方式の
ほうが将来のバージョンアップを考えるといいですね。勉強になりました。オブジェ
クトのシリアライズを「タグ付き」で行うライブラリありませんかね？自分で作りた
くなりました。多分将来変わるでしょう。

　グループ図形はいろいろ難しいは。しょっちゅうバグが出る。大きく受け止めてくださ
い（笑）。

　JW_CADのように左右両ボタンで拡大とかしたいんですけど、ひとまずあきらめた。やっ
ぱり基本クラスから作りなおさなきゃだめだ。

　文字入力時の「10H例外」の問題は多分「バージョン1.4.6ｄ」で解決したと思います。
　協力していただいた方ありがとうございます。
　またろくに調べもしないで環境のせいなどにしたかたにはお詫び申し上げます。私が未
熟でした。
　今回「10H例外」をいろいろ調べて面白かったのは、他の（メーカー物の）ソフトでも
起こってるみたい。でも、対策で「FPUを切れ」はないだろう。なんだかなぁ。プリンタ
ドライバが悪いなんてのもあったけど、本当か？私はひたしぶりにアセンブラコードを見
れて楽しかった。わかっちまうもんだなぁ。
　で、これからデバッグ情報をプログラムに入れましたので落ちたときは詳細情報を見せ
ていただければ（必ずではないけど）何とか原因がわかるかもしれません。
　でも、「モジュール : MFC40.DLL」のときは（多分）わかりません。
「モジュール : LILLICAD.EXE」のときのことです。

　感想や要望、バグレポートのメールありがとうございます。最近なんやかんやで忙しく
てだんだん、こちらからの返事が書けなくてすみません。あらためて御礼申し上げます。

　近頃、VC++4.1が調子おかしくて。もうだめかもしれません。そのうちVC++6.0あたりにの
りかえます。

---------------------------------------------------------------------------
★ 6. わかっているバグ
○明らかなバグ
・選択された図形のハンドルが時たま残る。
・文字が時々、ごみで残る
これらは再描画すれば消えるので、ほかってあります。
・演算ツールでORがうまくいかない時がある。
原因不明。計算時の誤差が影響しているような気がします。
○半分仕様
・円や楕円などを変形させるとなんか変
普通円をつぶせば楕円と思うでしょうが、LilliCadはポリゴンになります（手抜きです）。
同じように、円を一部切り取っても円弧ではなく、ポリラインです。
どちらも見た目は変わりませんので許してね。
・右ボタンでカーソルのところの色を読み取ることができるようにしましたが、あまり
うまく機能しないかもしれません。例えば、スナップしていても、うまく読み取れない
ときがあると思います。

---------------------------------------------------------------------------
★ 7. 連絡先
バグや要望のメールは以下のアドレスにお願いします。
               ran-yu@pluto.dti.ne.jp
できれば使っているバージョンもお知らせ下さるとうれしいです。
最新版(ベータ版ともいう)は以下のところに置いときます。
               http://www.pluto.dti.ne.jp/~ran-yu/index.html

★ 8.再配布について
　本体（LilliCad.EXE）に変更が無ければ、配布は自由です。その他のファイルについて
はとくに添付の強制はしません（しかし、LilliCad.TXTくらいはあったほうがいいかな？)。
　作者への連絡も特に必要ありません（でも、お知らせしてくれればうれしいです）。
　HELPファイルのLilliCad.htmの変更は認めます。使いやすい物を作れる人は作ってくだ
さい（ですが、変なウィルスは入れないで下さい（笑））。
　配布物にパーツや図面ファイルなどを加えることも当然許可します。
　しかし、配布するパーツなどの著作権や配布条件は当然尊重してください。とくに、フリ
ーのJWKの図形などをLilliCadの形式に変換した場合は注意してください（その図形の作者
がこのような使い方を想定していないおそれがあるため)。
　本体及びその他ファイルを（LHAなどで）アーカイブ及び圧縮しても問題はありません。

　なんかだらだら書きましたが、私の考えとしては「本体がそのままならファイルを加えよ
うが圧縮しようが後はあなたの責任において自由にして」といいたいだけです（たった2行)。

　雑誌、書籍等への収録も許可は要りませんが、事前もしくは事後にお知らせしてくれればう
れしいです（友達に自慢しますので）。ですが、収録記事内容の確認をPDFで依頼したり、動
作環境等の疑問点をPDFのレイアウト中に書かないでください。あと、収録許可や動作環境の
確認を締め切り１日前にメールで送らないでください（ちょっとは余裕見てよ）。

---------------------------------------------------------------------------
★ 9.変更履歴またの名をバグの歩み

Ver0.800	ひとまずのベータリリース

Ver0.801	ビットマップが256色環境で正常に表示されない不具合修正
		（パレットを設定してなかった)

Ver0.805	ビットマップ、OLEなどのバイナリデータを圧縮保存できるようにした。
		圧縮には、"zlib"（http://www.cdrom.com/pub/infozip/zlib/）を使っています。

Ver0.807	一部ファイルが読み込み不能になる（とんでもない）不具合の修正。
		正多角形ツールを使うと落ちる（致命的)不具合の修正。
		扇形の表面スナップがうまくできなかった不具合修正。
		分割点が正常に働かない不具合修正。

Ver0.808	OLE図形があるファイルをダブルクリックで起動できない問題を修正。

Ver0.809	円のツールに他の線に「接する」円を描く機能の追加。でも、中心指定円のみ。
		3点円はまだどうするか未定。
		選択ツールの複数選択でどれが選択されてるかわかるようにした（でもなんか
		みっともないのでまた変えるかも)。それにともない、選択ツール内部をちょっ
		といじったので動作が怪しくなってるかも。
		圧縮形式ビットマップのファイルが（文字化けなんかで）壊れていてもとにか
		く何か表示するようにした。

Ver0.810	「拡大・縮小」ツールバーに拡大・縮小率指定コンボボックスを追加。
		オプションに選択時の表示モードを追加。
		選択ツールの表示ロジックの見直し（ちょっと速くなった)。
		ビットマップのパレットを開放するようにした（使う人には直接には関係ない)。
		Undo可能回数が多すぎるなどでメモリが不足した場合はUndo可能回数を減らすよ
		ううながすダイアログを出すようにした（仮想メモリが足りなくなることが起こ
		るとは考えていなかった、、、。根本的な解決は、メモリ管理を自分でやること
		だと思うけど、とてもそんな技術はありません。大きなビットマップを貼り付け
		る人はHDは十分あけて、仮想メモリを十分取れるようにしましょう。ちなみに、
		仮想メモリが足りないと、ビットマップをクリップボードからコピーするときに
		失敗してWindows98が落ちるときがあります。これは、私のせいではないです。
		たぶん）。
		Undo可能回数の初期値を8回とした（減らした)。でも、設定可能な上限は（たし
		か)1000回だったりするけど、ビットマップを貼り付ける人はあまり大きくしな
		いでね。線図形だけなら1000回でもたぶん大丈夫(あまりおすすめしませんが)。

Ver0.811	連続線ツールでポリラインを描けるようにする（数値入力のオプション)。
		選択ツールで線の太さ、矢印の大きさ等の変更が正常にできない問題の修正。

Ver0.811b	オプションで選択時の表示モードで、反転表示（強調表示）を選択した場合、
		リソースの開放漏れがあったので修正。
		引き出し線図形の見直し(開発途中)。

Ver1.0.0	一応、正式公開版。
		ファイルフォーマット変更（でも、今までのも読める)。
		引き出し線、バルーン図形をグループ化図形から、独立した図形とする。
		
Ver1.0.1	多角形ツールでダイアログが出た後にごみが残ることがあるバグの修正。
		ツールバーのコンボボックスにツールチップが無かったので追加。

Ver1.0.2	オプションに保存モード「ノーマル」、「バックアップを作る」、「安全に保存す
		る」オプションの追加。これでちょっと安心ね。

Ver1.1.0	JW_CADのファイル（JWC)入出力。JWKはフォーマットがわからないので未対応。
                DXF読み込みで縦書きに対応。
　　　　　　　　JWC、DXFなどのファイルをドラッグで読み込み可能とした。
                JWC、DXFなどのファイルを「ファイル」→「開く」でファイルの種類を選択し
　　　　　　　　て読めるようにした。同じように保存もできるようにした。
　　　　　　　　大きなファイルの読み込みで時間がかかっていたのをちょっと速くした。
　　　　　　　　しかし、その分実行速度が遅くなったかも(スナップが特に)。
		文字の縦書きを追加（今までの@付きフォント＋角度270°の廃止)。
　　　　　　　　文字入力ダイアログ変更（フォントの設定を無くした)。
　　　　　　　　数値入力ダイアログの見なおし(チェックボックス周り)。
　　　　　　　　寸法線の数値入力(？)の変更（選択モード時のダブルクリック時)。
                その他もろもろ。
　　　　　　　　きっとこれだけ変更されていればバグも増えてるでしょう。

Ver1.1.1	他のレイヤが非表示でもスナップが効いてしまう困ったバグの修正。
　　　　　　　　新規作成時に用紙の大きさとグリッドを指定できるようにした。

Ver1.1.2	前回終了した時がWindowが最大化表示なら次回も最大化表示に変更。
　　　　　　　　DXFファイルのテキストで%%pで±、%%o,%%uは何も表示されない（というか
　　　　　　　　引き続きテキストがそのまま表示される）ようにした（以前は%%を除いて
　　　　　　　　表示されていた)。%%xxx（xxxは十進数）は未対応。たぶん後ろの2桁の数
　　　　　　　　字が表示されるでしょう。
　　　　　　　　DXF読みこみでキャンセルできるようにした。
                用紙サイズ、グリッドサイズなどが前回ダイアログで設定した値が次回も
　　　　　　　　表示されるようにした。
                ファイルを開くとき前回開いたときのファイルタイプを記憶するようにした。

Ver1.1.3        JWC読みこみで縦書き文字のフォントが@付きのフォント（過去のバージョン
　　　　　　　　の名残)だったのを正常に直す。
                まだ不具合は直接無かったけど、メモリリークを発見（数バイト)。修正。
                選択ツールで「ハンドルドラッグで移動」チェックを付けていても、一度
　　　　　　　　図形の選択を解除するとチェックが外れる（ドラッグサイズになる)ことを
　　　　　　　　やめる。

Ver1.1.4        新規作成ダイアログ変更。簡易テンプレート機能追加。
　　　　　　　　ウィンドウの最大化表示の保存関係でバグがあったので修正。
　　　　　　　　選択ツールで文字をダブルクリックしたときのダイアログで縦書きチェック
　　　　　　　　ボックスが正常に働かなかったのを修正（機能付け忘れ）。

Ver1.1.5  　　　演算ツールでORがきかないときがあったので修正。でも、まだおかしいかも？
                古い保存形式（バイナリ形式）のサポート廃止（困るのは私ぐらい）。
　　　　　　　　DXFファイルのテキストで%%pで±の本当のサポート（Ver1.1.2でしたつもり
　　　　　　　　だったけど落としてました）。
		DXFファイルのテキストで%%の次の文字が大文字でも表示できるようにする。
　　　　　　　　DXF保存で縦書きのサポート。
　　　　　　　　内部的なクラスの見なおし（ちょっと速くなったかな？でもほとんどわから
　　　　　　　　ない）。
　　　　　　　　選択ツールで座標入力に対応。これで複線もどきも出来るかな？まず、線を
　　　　　　　　選択して（このとき真中付近をたたくのがコツ)座標入力の相対座標入力で
　　　　　　　　距離を入力すれば複線みたいなことが出来ると、なんか書くと面倒だけど、
　　　　　　　　実際はそんな面倒じゃないと思う（JW_CADのようにはいかないけど）。
                交点判定方法変更。おかしくならなきゃいいけど？
　　　　　　　　包絡ツール変更。ちょっと賢くした（と言うより今までが手抜きだった)。結
　　　　　　　　構プログラムが複雑になったけど、まだおかしいかな？誰かアルゴリズム教え
　　　　　　　　てください(笑)。
　　　　　　　　ポリラインかしたときに線の属性が消えていた(黒の実線になった)が、出来る
　　　　　　　　だけ残すように変更。
                反転時の表示で強調表示時に、ごみが残るときがあったので修正。
                円の表示で線のかくかくを少し減らした（３２分割→４８分割）。
　　　　　　　　これだけ変更してバグがでないほうが不思議だね(笑)。

Ver1.2.0  　　　ストレッチツールの追加。
　　　　　　　　選択時のハンドル描画をXORからCOPYにした（気にしないでください）。
                描画時の方法を変更（上の事と関係して）。
                レイヤのタブ表示方法変更。ボールド：印刷可、アンダーライン：選択可、
　　　　　　　　淡色表示：表示不可、タブが選択されたとき：白色
		グループ図形のフォーマット変更。
　　　　　　　　グループ図形のスナップ編集の廃止。使いづらいので（使ってた人いた？)。
　　　　　　　　あわせてパーツにも多少変更あり。
		パーツのフォーマット変更。これにともない、Ver1.2.0以上で作ったパーツ、
　　　　　　　　ついか、削除等編集を行ったパーツファイルはそれ以前と互換性が無くなる。
                パーツ保存のタイミングを終了時でなく、変更をかけた時に変更。
　　　　　　　　パーツファイルが保存失敗時に消えたので、出来るだけそんなことが起こらな
　　　　　　　　いようにする。
                ビットマップ図形の回転を可能にした。OLEで貼り付けたものは相変わらず不
　　　　　　　　可。回転後のにできる図形の隙間（？）は白色に固定（ひとまず）。たかが回
　　　　　　　　転、されど回転で結構難しかった。
　　　　　　　　ビットマップ図形に限り、DIBでクリップボードへコピー可能とした。

Ver1.2.1  　　　レイヤ選択タブの右ボタンメニューに他のレイヤ表示メニューを追加。普通の
　　　　　　　　時の右ボタンメニューの他のレイヤ表示メニューを削除。
　　　　　　　　水平・垂直線ツールに任意の角度のスナップを追加（5,10,15,30,45,90°）。
　　　　　　　　これじゃ水平・垂直線とは言わんと言うのはおいといて(笑)。

Ver1.2.1a  　　 ハッチングツールで落ちるバグ修正。
　　　　　　　　コピーするとレイヤーの順番が逆になるバグの修正。

Ver1.2.1b       選択ツールで違う線種の線を複数選択してツールバーの線種コンボボックスで
　　　　　　　　線種を変更するとき空白部分選択で落ちるバグの修正。
　　　　　　　　その他、ツールバーのコンボボックス関係のおかしな動作の修正。
　　　　　　　　塗り矢印の塗り部分がかかれないときがあったので修正。
                水平・垂直線ツールで終点指定時スナップが効かなかったので修正（Ver1.2.1
　　　　　　　　でおかしくなった）。

Ver1.2.2        何かの間違いで文字のフォント名が空白になったときでも表示が正常に行われ
　　　　　　　　るように（多分）した。

Ver1.2.3a       選択ツールで移動時SHIFTキーを押したままだと水平・垂直移動とした。
　　　　　　　　レイヤのタブ表示で非表示レイヤが選択されたとき、グレー表示にならなかっ
　　　　　　　　たのを修正。

Ver1.2.3b       二線分内消去で落ちるバグの修正（Ver.1.2.1aで多分作りこんだ）。
　　　　　　　　寸法線を選択ツールで文字位置が変更できない問題の修正。
　　　　　　　　線の書き方の変更（終点を１ドット分延ばしてたけどメタファイル書き出しで
　　　　　　　　「ごみ」が出るのでやめた。そのかわり、画面上で線と線の「つなぎ目」が１
　　　　　　　　ドットばかり空く時があります。
                線分線切断で完全に交差していなくても切断できるようにした。

Ver1.2.3c       選択ツールで引き出し線、バルーンを変形できない(変形すると落ちる)問題の
　　　　　　　　修正（Ver.1.2.0で多分作りこみ）。
                コーナーツールで正常に処理されない問題修正（Ver.1.2.3bで作りこみ）。
　　　　　　　　複数文字をメタファイルでEXCELなどに張り込むと図形が消えるバグの修正（
　　　　　　　　クリッピング領域設定ミス？）。
                点線の空白部分でも線上なら選択可能とした。

Ver1.2.3c       線の書き方の変更（Ver1.2.3bで終点を１ドット分延ばすのをやめたけど、メタ
　　　　　　　　ファイルのときだけそうするようにした）。
　　　　　　　　グラデーションの書き方変更。

Ver1.3.0        線種に補助線追加。補助線は、過去のバージョンでは読めません（エラーで落
　　　　　　　　ちる)ので注意してください。
　　　　　　　　拡大・縮小で大きさを指定可とした。
　　　　　　　　選択した図形を線に対して対称コピー機能追加。
　　　　　　　　選択した図形を基準点指定コピー、移動。
　　　　　　　　印刷領域設定で一度決定したら、戻るようにした。

Ver1.3.1        バルーン、引き出し線で、文字など一部の色が黒以外にならないバグの修正。
                線ツールの（内部的）変更。連続線や壁の調子がおかしかったので（線ツール
　　　　　　　　はそれらの基本クラスのため）。

Ver1.3.1        JWCの補助線に対応。
　　　　　　　　基準点指定回転,反転の追加。

Ver1.3.2　      ポリゴンの面積計測に対応。円なんかの面積は誤差が出るね。もともと近似し
　　　　　　　　てるから。

Ver1.3.2a       小数点２桁精度の寸法値が正確にとれない問題の修正。
                寸法書式設定画面で更新ボタンや削除ボタンで落ちる問題の修正。
                ポリゴン、スプラインループ描画中で、２点目指定時に線が消えていた（XOR描
　　　　　　　　画なので消えていた)のを見えるようにした。
　　　　　　　　円の面積に対応。

Ver1.3.2b       DXF読みこみでTEXTのスタイルが設定されていないときに縦書きになるとんでも
　　　　　　　　ない問題の修正。
                巨大なグループ図形の描画速度の改善。
                スナップの検索方法変更。今までキャッシュしてたんだけど、意味が無かったの
　　　　　　　　でやめた。
　　　　　　　　時々、円弧などがおかしくなる問題の修正（一部関数にvirtual付けるの忘れた。
　　　　　　　　できるだけ付けるようにしてたんだけどね。これだからC++は、、、）。
                フォントが小さくなるとTEXTが消える（特にグループ図形や引き出し線など）問
　　　　　　　　題の修正（0.6mmとか、、、使うのね）。
                バルーンと引き出し線の文字を一番最後に書くように変更。これで、面色でバル
　　　　　　　　ーン円の内部をぬれます（引き出し線は影響無し）。

Ver1.3.3        複数行文字で折り返しを可能とした。

Ver1.4.0        選択ツールでなにか選択した状態でDXFなどの他形式のファイルを読みこむと落ち
　　　　　　　　るバグの修正。
                選択ツールで寸法線をダブルクリックで編集したとき、オプションで設定ダイア
　　　　　　　　ログ表示後、そのダイアログを閉じて、メインウィンドウをたたき、ＯＫボタン
　　　　　　　　を押すと（説明が長い、、、)落ちるバグの修正。モーダルダイアログの親ウィ
　　　　　　　　ンドウの指定がまずかったみたい。
                文字図形に枠線および背景の塗りの追加。
　　　　　　　　文字の色と、枠の色を分ける（今までは「線の色＝文字の色」だったが文字の色
　　　　　　　　を別に指定できるようにした（ＥＸＣＥＬやＷＯＲＤの図形のように）。ちなみ
　　　　　　　　に線の色が文字枠の色ね。
                文字図形の修正にともない、引き出し線やバルーンも形式変更。
　　　　　　　　Lillicad.iniが壊れるとツールバー表示部分で落ちたので、その場合、次回立ち
　　　　　　　　上げ時はツールバー情報を読まないようにした。
　　　　　　　　角度図形の文字位置を常に円の外側に書くようにした。
　　　　　　　　色の選択で、あらかじめある色以外にも選択できるようにした（標準ダイアログ
　　　　　　　　使用）。
　　　　　　　　なんかいろいろと付け加えてきました。バグがあったらすみません。

Ver1.4.1        JW_CAD補助仮実点読みこみを（全ての図形で)ペン番号7を強制的に補助線とする
　　　　　　　　ことで対応。こんなのあったのね。でも、補助保持は対応していません（今のと
　　　　　　　　ころLilliCad側に対応する機能が無いので。文字色青で補助線の枠付きの図形に
　　　　　　　　変換されます（文字の印刷はされます)。
                複数行文字のDXF出力対応。1行の文字（TEXT)にへんかんされます（MTEXTではな
　　　　　　　　い)。でも、文字関係はDXF,JWCとも枠の出力無し。複数行文字の折り返しがあっ
　　　　　　　　ても無視されます。
		JWK（JW_CADの図形ファイル）をパーツとしての読込みに対応。ひとまず読めるみ
　　　　　　　　たい。

Ver1.4.2        複数行文字で、折り返し時改行が正常に処理されない問題の修正。
　　　　　　　　Lillicad.ini破壊時の対応で、Ver1.4.1にするとツールバーが初期状態に戻った
　　　　　　　　ので正常読込み時はそうならないように修正。
　　　　　　　　文字図形に枠線のグレー表示等のし方の変更。

Ver1.4.3        スナップの検索方法変更。ひたすら検索していたので、図形が多くなるとカーソ
　　　　　　　　ルの動きが止まっていたけど、カーソルが動くと検索を中止するようにした。
                DXF,JWCに枠付きテキストの枠の出力。
　　　　　　　　JWCの読込みがおかしくなってた（Ver1.4.1から）ので修正。

Ver1.4.4        JWC読込みで色指定を可能とした。
	        JWK読込みで色指定、線幅指定を可能とした。
　　　　　　　　パーツのアイコンの描画を変更。ポリゴンの塗りが無いときは塗らなくした。す
　　　　　　　　でに作ってしまったパーツは変更しないのでなんだかなー。
　　　　　　　　右ボタンを押したところの色を、線色や面色や文字色へコピー可能とした。だけ
　　　　　　　　ど、かなり無理やりなんで、おかしくなるかも？あと、グリッドの「黒点」の色
　　　　　　　　もコピーするので注意してね（仕様です、と言うか私の限界）。右ボタンメニュ
　　　　　　　　ーで、この色を、、、の階層の下のメニューで可能。
　　　　　　　　初めてインストールしたとき「ファイル」「図形スタイル」「文字」「拡大・縮小」
　　　　　　　　のツールバーが表示されるようにした（迷わないように）。

Ver1.4.5        Ver1.4.3でスナップの検索を変更したときにグループ図形がおかしくなったので
　　　　　　　　変更。
                DXF読込みで、不正な図形（例えば長さが0の線や、半径0の円など）があったばあ
　　　　　　　　い、おかしくなったので修正。
Ver1.4.5a       白黒印刷をテスト実装。
Ver1.4.6        グループ図形でグループ化された図形のうち不正な図形があったらグループ図形
　　　　　　　　自体を不正な図形としたが、グループ図形はどんな場合でも不正でないとした（
　　　　　　　　将来への布石？)。
                図形の白黒印刷に対応。印刷、プリンタ設定ダイアログの「白黒印刷」チェック
　　　　　　　　ボックスでね。でも、OLEやビットマップなんかはこのチェックボックスは働き
　　　　　　　　ません。プリンターの機能で対応してね。それにしても、なんでPrintDialogは
　　　　　　　　FileDialogと違ってネストできないいんだ？めんどくさい。
                JWKで、JWKの縮尺が現在の用紙と違いすぎるとアイコンがおかしくなる問題修正。
Ver1.4.6a       メニューにテスト時のごみがあったので削除。
Ver1.4.6b       寸法線設定ダイアログの書式設定で変更が正常に反映されない問題の修正。あわ
　　　　　　　　せて、その他の"CComboBox"の"SelectString"を使っていたところを変更。
                半径寸法ツールで円の外から引いたとき、常に中心から線を引くオプション追加。
                1行文字のサイズの決め方をちょっと変える（内部だからあまり関係ない)。
                計測ツールで情報表示ダイアログの文字のカーソルを先頭へ持っていった（長い
　　　　　　　　文字列だと後ろが表示されるから)。
                寸法図形で、6.195mmが6.2/5（何じゃそりゃ！）となるバグの修正。浮動小数点
　　　　　　　　の誤差で変になってた。BCD演算のライブラリないかな〜（もう遅いが）。
Ver1.4.6c       1.4.6ｂが正常に動いてる方は関係ないです。文字入力で「10H例外」が出る場合
　　　　　　　　の調査用です。あくまで調査ですので、バグの修正はしていません。具体的には
　　　　　　　　デバッグ情報をいれました。「LILLICAD の 10H 例外」ダイアログで、「詳細」
　　　　　　　　ボタンを押して表示される情報を連絡していただけると、こちらでエラーの場所
　　　　　　　　を特定できます。どうも、「10H 例外」はFPUの関係みたいでいろいろ調べてる
　　　　　　　　んですが、ある特定の状況でしか出ないみたいです。だから修正可能かもまだ未
　　　　　　　　知数です。
Ver1.4.6d       Ver1.4.6cで「10H 例外」の原因が（多分）わかったので修正。文字は実際に書
　　　　　　　　かれるまで大きさがわからないので、大きさが不定で運が悪いと無効な値が入る
　　　　　　　　みたい。今回デバッグ情報のありがたみがわかったのでこれからはつけるつもり。
　　　　　　　　まだフロッピーに入るけど、特徴からは削除。
Ver1.4.7        3点円ツール、3点円弧ツールで数値入力の半径指定を可能とする。
　　　　　　　　線ツールで「接する」を可能にする。
　　　　　　　　ツールバーの文字サイズコンボボックスがうまく選択されない問題の修正。
　　　　　　　　今回急ごしらえなので、ちょっと不安。
Ver1.4.7a       グループ図形で回転、反転等すると円弧などの中心点が消える（と言うか円弧
　　　　　　　　でなく、ポリラインになる)問題の修正。
Ver1.4.7b       VideoCardの"ATI ALL-IN-WONDER128"が16bit,32bitカラーのとき選択、及び表
                面スナップが効かない問題の修正（他のカードではいまのところ正常なのでド
                ライバーが怪しい気がする）。かなり怪しい修正なのでおかしかったら教えて
                ください。
　　　　　　　　ちなみにALL-IN-WONDER128はいまお気に入りです。
Ver1.4.8        ALL-IN-WONDER128のドライバの問題は解決しないけどひとまず、Ver1.4.7b系の
　　　　　　　　開発終了（古いドライバに戻す）。
　　　　　　　　円のスナップで中点が端点スナップと変な風に混同していたので修正。ついでに
　　　　　　　　円の45度スナップもつける。
　　　　　　　　DXF保存で補助線があると不正な処理で落ちるバグを修正。DXF上で補助線はスタイル
　　　　　　　　名"HOJO"で保存。でも、印刷されちゃうのできをつけてね（なにか方法はある？）。
　　　　　　　　最近VC++4.1の調子がおかしい。もうしおどきかな（笑）。
Ver1.4.8c       JWC読込で仮点が128以上のレイヤーにあると以上終了する問題の修正。
　　　　　　　　とてもVC++4.1の調子がおかしくて修正するのも一苦労。直さなきゃいけないところ
　　　　　　　　はたくさんあるんだけど。わかるけどね。もう時代遅れって。VC++6.0もあるけどこ
　　　　　　　　れ使うとMFC4.2問題と向き合う必要があるから避けたいです。どうしてもVC++6.0つ
　　　　　　　　かうなら別のCADになるでしょう（構想だけは着々と、、、）。
Ver1.4.8d       ツールバーが前回起動時と違う変な位置に表示される問題の（多分）修正。
Ver1.4.8e       ビットマップ表示のとき今まで縮小時、間引きで表示していたが黒を保存するようにした
　　　　　　　　（オプションのビットマップ表示補間。SetStretchBltMode()でSTRETCH_DELETESCANSだっ
　　　　　　　　たのをBLACKONWHITEも選択できるようにしたんだね）。きれいになりますが、表示は多分
　　　　　　　　遅くなります。
Ver1.4.8f       ウィンドウを最大表示状態で終了すると次回起動時にウィンドウをリサイズできる状態で
　　　　　　　　最大表示（説明しずらい）になってしまう問題の修正。多分いいけど、もしかしたらまた
　　　　　　　　ツールバーの表示に問題が出るかも（Ver1.4.8dで直したのが再発するか？今のところいいけど）。
Ver1.4.8g       JWCファイルなどで同じレイヤ名で同じグループ名が存在する時、レイヤを追加すると
　　　　　　　　ページ違反で落ちるバグの修正。その対策として、同じレイヤ名で同じグループ名の場合、
　　　　　　　　次からは"Group名-レイヤ名-n"(nは1から順次カウント)とした。
Ver1.4.8h       ズームの倍率指定の表示数値がおかしかったのを修正。
　　　　　　　　レイヤ名の変更で他のレイヤと同じ名前がある時は変更できないように修正。
　　　　　　　　Windows2000 or Windows XPで起動できない問題の修正。1.4.8ｆで作りこみました。
　　　　　　　　Windows2000でチェックしましたが、多分WindowsXPでもいいと思います。
　　　　　　　　（いろいろとバグレポートありがとうございました）。
Ver1.4.8i       Windows2000,WindowsXPで、図形を他のアプリケーション（EXCELとか）に貼り付けできない
　　　　　　　　バグの修正。
　　　　　　　　zlibを1.1.4にした（今ごろでごめんなさい）。
　　　　　　　　図形の全て選択を可能とした（「編集」->「全て選択」）。なんで今まで無かったんだろう？
Ver1.4.8j       Ver1.4.8iではまだ完全にWindows2000,WindowsXPで、図形を他のアプリケーションに貼り付け
　　　　　　　　できない問題が直っていませんでした。今度はいいと思います。
Ver1.4.8k       Windows2000上のExcel2000に図形をメタファイルで貼り付けた時、縦書きの文字がおかしくなる
　　　　　　　　問題の修正（LOGFONTのlfOrientationが使ってなかった）。
Ver1.4.8l       2WheelMouse(A4Tech製など)のドライバーがインストールされると横スクロールバーが押せない
　　　　　　　　問題の修正。また、そのマウスでもWheelで横スクロールができるように修正。こんなマウスは
　　　　　　　　想定外（笑）。でも、図面を書くには結構良いマウスです。しかし、ボタンが5つあっても押せな
　　　　　　　　いですよ。
Ver1.4.8m       オプション「メタファイルをプリンター解像度とする」を追加。
Ver1.4.8n       WindowsNT4.0で複数行テキストを使いコピーすると異常終了する問題の修正。メタファイルに
　　　　　　　　ExtTextOutで書きこむとき落ちてたみたいです。Windows2000や98では問題なかったみたいです。
　　　　　　　　グループ図形、寸法図形等をメタファイルで保存できない問題の修正。やっぱりメタファイルは苦手。
　　　　　　　　OLEで貼り付けた図形が編集後大きさが変わったりしたのの修正。
Ver1.4.8o       WindowsXP,2000,NTでNTFSの場合、iniファイルの書き込みができないのでツールバーの状態などが
　　　　　　　　保存されませんでした。そこで、レジストリを積極的に使用するように変更。あわせてレジストリ
　　　　　　　　消去機能を追加。Unregist.batを実行すると関係するレジストリエントリーの削除。
　　　　　　　　エクスプローラーの新規作成でファイルを作ると、空のファイルができるが開くとエラーで開けな
　　　　　　　　かった問題の修正。
　　　　　　　　マウスのホイールで拡大縮小できるようにした。ホイールを押すとそこを中心に移動するようにしたが、
　　　　　　　　いまいち直感的でないので変更するかも。
　　　　　　　　いいかげん、いま作成中のあたらしいCADも公開したいが、まだまだ完成度が低くてなんとも。
Ver1.4.8p       CTRLキーを押しながらマウスホイール回転で拡大縮小とした。何も押さずにホイールをまわすと
　　　　　　　　スクロール。某2WheelMouseはそれじゃないとだめみたいだから。
Ver1.4.8q       EXCEL2000で計算オプションに表示桁で計算を設定しているものを貼り付けた場合、そのオプションが
　　　　　　　　解除されて表示される問題の修正。しかし、ダブルクリックでそれを編集すると、そのオプションは
　　　　　　　　解除されます（どうも、そういうものらしい）。
　　　　　　　　OLEのリンク貼り付けができるようにする。
Ver1.4.8r       EXCEL2000で計算オプションに表示桁の問題で、ファイルを保存して読み込むと1.4.8q以前と同じ状況
　　　　　　　　になる問題の修正。
　　　　　　　　OLEのリンク貼り付けで、削除したオブジェクトもリンクが残っていたので修正（UNDOのバッファに残ってた）。
　　　　　　　　DXF読み込みでPOLYLINEの線種、線色が正常に読み込めない問題の修正。
Ver1.4.8s       Ver1.4.8rでOLE周りにバグを作りこんでしまったので、いったんVer1.4.8qまでバックトラック。
　　　　　　　　Ver1.4.8rと同じ仕様にしたつもり。
　　　　　　　　EXCELでなぞの現象を発見（今頃）。貼り付けた時は枠線が無いのに、貼り付けた後に編集すると枠線が出る。
　　　　　　　　リンク貼り付けだと最初から枠線あり。UpdateLink()を貼り付けた後に呼べば枠線が最初から出るのだが、
　　　　　　　　そうするとVer1.4.8qの問題が再び表れる。WordPadやWordでも同じ現象が起こるので、仕様なんですよね？
　　　　　　　　これをバグと言われても大変困るので、勘弁してください。お願い。
　　　　　　　　ビットマップ貼り付けで32ビットのビットマップのときに色がおかしくなる問題の修正。マスクを忘れてた。
　　　　　　　　OLEオブジェクトが貼り付けられた状態でレイヤーをコピーもしくは移動すると異常終了する問題の修正。
Ver1.4.8t       白黒印刷で塗りつぶしのある矢印に色がつく問題の修正。
　　　　　　　　DIBを貼り付けるとき解像度と大きさをちゃんと反映するようにした。
Ver1.4.8u       DIB貼り付けでDIBの解像度(BITMAPINFOHEADERのbiXPelsPerMeter,biYPelsPerMeter)が0の場合、画面の
　　　　　　　　解像度を使うように変更。
Ver1.4.8v       選択フィルタの仮実装。選択ツールで「図形」「選択フィルター」「フィルターオプションで」選択できる
　　　　　　　　図形をチェックし、同「フィルターON」で特定の図形のみ選択可能。
　　　　　　　　ツールバーの配置が再起動時に狂う問題を少しだけ修正。
　　　　　　　　ウィンドウの最大化時に最近使ったファイルを開くと最大化が解除される問題の修正。
　　　　　　　　線上複写、円上複写で、円が正常に回転されない問題の修正。
